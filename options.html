<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title data-i18n="opt_title">AmoNexus Settings</title>
    <link rel="stylesheet" href="ui_shared.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            padding: 40px 20px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        /* Main Container - Flex Layout */
        .options-container {
            display: flex;
            max-width: 800px;
            width: 100%;
            background: var(--surface);
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            min-height: 600px;
        }

        /* Sidebar Navigation */
        .options-nav {
            width: 180px;
            min-width: 180px;
            background: var(--background);
            border-right: 1px solid var(--border);
            padding: 24px 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .nav-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 12px;
        }

        .nav-header h2 {
            margin: 0;
            font-size: 18px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            border: none;
            background: transparent;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-size: 14px;
            border-left: 3px solid transparent;
            width: 100%;
        }

        .nav-tab:hover {
            background: rgba(16, 185, 129, 0.05);
            color: var(--foreground);
        }

        .nav-tab.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-icon {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .nav-footer {
            margin-top: auto;
            padding: 16px 20px;
            border-top: 1px solid var(--border);
        }

        /* Content Area */
        .options-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .tab-panel {
            display: none;
            flex: 1;
            opacity: 0;
            transform: translateX(10px);
        }

        .tab-panel.active {
            display: block;
            animation: fadeSlideIn 0.25s ease forwards;
        }

        @keyframes fadeSlideIn {
            from {
                opacity: 0;
                transform: translateX(10px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .tab-panel h2 {
            margin: 0 0 24px 0;
            color: var(--foreground);
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab-panel h2 svg {
            color: var(--primary);
        }

        /* Settings Sections */
        .setting-section {
            margin-bottom: 24px;
        }

        .setting-section:last-child {
            margin-bottom: 0;
        }

        .setting-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        .setting-row-info {
            flex: 1;
        }

        .setting-row-info .title {
            font-size: 14px;
            font-weight: 600;
            color: var(--foreground);
        }

        .setting-row-info .desc {
            font-size: 12px;
            color: var(--muted);
            margin-top: 4px;
        }

        /* Form Elements */
        label {
            font-weight: 600;
            font-size: 14px;
            display: block;
            margin-bottom: 8px;
            color: var(--foreground);
        }

        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            box-sizing: border-box;
            background: var(--background);
            color: var(--foreground);
            transition: all 0.2s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(16, 185, 129, 0.05);
            box-shadow: 0 0 10px var(--primary-glow);
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--background);
            color: var(--foreground);
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            box-sizing: border-box;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 10px var(--primary-glow);
        }

        select {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            box-sizing: border-box;
            background: var(--background);
            color: var(--foreground);
            cursor: pointer;
        }

        select option {
            background-color: var(--background);
            color: var(--foreground);
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
            flex-shrink: 0;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: 0.3s;
            border-radius: 26px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: var(--foreground);
            transition: 0.3s;
            border-radius: 50%;
        }

        .toggle-switch input:checked+.toggle-slider {
            background-color: var(--primary);
            box-shadow: 0 0 10px var(--primary-glow);
        }

        .toggle-switch input:checked+.toggle-slider:before {
            transform: translateX(22px);
            background-color: #fff;
        }

        /* Radio Cards (Sensitivity) */
        .sensitivity-group {
            display: flex;
            gap: 10px;
        }

        .radio-card {
            flex: 1;
            position: relative;
            cursor: pointer;
        }

        .radio-card input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .card-content {
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 16px 12px;
            text-align: center;
            transition: all 0.2s;
            background: var(--background);
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .radio-card input:checked+.card-content {
            border-color: var(--primary);
            background: rgba(16, 185, 129, 0.1);
            box-shadow: 0 0 15px var(--primary-glow);
            transform: translateY(-2px);
        }

        .card-content .emoji {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
            color: var(--primary);
        }

        .card-content .title {
            font-weight: 700;
            font-size: 13px;
            color: var(--foreground);
            display: block;
        }

        .card-content .desc {
            font-size: 11px;
            color: var(--muted);
            margin-top: 4px;
            display: block;
        }

        /* Custom Dropdown */
        .custom-dropdown {
            position: relative;
            width: 100%;
        }

        .dropdown-selected {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            box-sizing: border-box;
            background: var(--background);
            color: var(--foreground);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .dropdown-selected:hover {
            border-color: var(--primary);
        }

        .custom-dropdown.open .dropdown-selected {
            border-color: var(--primary);
            background: rgba(16, 185, 129, 0.05);
            box-shadow: 0 0 10px var(--primary-glow);
        }

        .dropdown-arrow {
            transition: transform 0.2s;
        }

        .custom-dropdown.open .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-options {
            position: absolute;
            top: calc(100% + 4px);
            left: 0;
            right: 0;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-8px);
            transition: all 0.2s ease;
            z-index: 100;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .custom-dropdown.open .dropdown-options {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-option {
            padding: 12px 14px;
            font-size: 14px;
            color: var(--foreground);
            cursor: pointer;
            transition: all 0.15s;
            border-left: 3px solid transparent;
        }

        .dropdown-option:hover {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--primary);
            color: var(--primary);
        }

        .dropdown-option.selected {
            background: rgba(16, 185, 129, 0.15);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .dropdown-option.selected::after {
            content: '';
            float: right;
            color: var(--primary);
        }

        /* Collapsible Guide/Advanced */
        .guide-details,
        .advanced-settings {
            margin-top: 12px;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
        }

        .guide-details summary,
        .advanced-settings summary {
            padding: 12px 16px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .guide-details summary:hover,
        .advanced-settings summary:hover {
            color: var(--primary);
            background: rgba(16, 185, 129, 0.05);
        }

        .guide-details[open] summary,
        .advanced-settings[open] summary {
            border-bottom: 1px solid var(--border);
            color: var(--primary);
        }

        .guide-content,
        .advanced-content {
            padding: 16px;
        }

        .guide-content ol {
            padding-left: 20px;
            margin: 0;
            font-size: 13px;
            color: var(--muted);
            line-height: 1.8;
        }

        /* Grid layouts for settings */
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .settings-grid.three-col {
            grid-template-columns: 1fr 1fr 1fr;
        }

        /* Subsection headers */
        .subsection-header {
            font-size: 15px;
            font-weight: 600;
            color: var(--foreground);
            margin: 24px 0 16px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .subsection-header:first-child {
            margin-top: 0;
        }

        .subsection-header svg {
            color: var(--primary);
        }

        /* Hero box for API key */
        .hero-box {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, transparent 100%);
            border: 1px solid var(--primary);
            padding: 20px;
            border-radius: 14px;
            text-align: center;
            margin-bottom: 20px;
        }

        .btn-get-key {
            background: var(--primary);
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 20px;
            display: inline-block;
            box-shadow: 0 0 15px var(--primary-glow);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-get-key:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 25px var(--primary-glow);
        }

        /* Action buttons */
        .btn-action {
            padding: 12px 16px;
            background: transparent;
            color: var(--foreground);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
            font-size: 14px;
        }

        .btn-action:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: rgba(16, 185, 129, 0.05);
        }

        /* Save bar */
        .save-bar {
            margin-top: auto;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        #btn-save {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        #btn-save:hover {
            background: var(--primary-hover, #059669);
            box-shadow: 0 0 20px var(--primary-glow);
        }

        #btn-save:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        #status {
            margin-top: 12px;
            text-align: center;
            font-size: 14px;
            min-height: 20px;
        }

        .success {
            color: var(--primary);
        }

        .error {
            color: var(--danger);
        }

        /* Hint text */
        .hint-text {
            font-size: 11px;
            color: var(--muted);
            margin-top: 6px;
        }

        .hint-text.warning {
            color: #F59E0B;
        }

        /* Hint (alias for hint-text for Wave 1 compatibility) */
        .hint {
            display: block;
            margin-top: 4px;
            font-size: 12px;
            color: var(--muted);
            font-style: italic;
        }

        /* Tooltip styles for Wave 1 */
        .info-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            line-height: 16px;
            text-align: center;
            font-size: 12px;
            color: var(--muted);
            cursor: help;
            margin-left: 4px;
            position: relative;
            vertical-align: middle;
        }

        .info-icon:hover {
            color: var(--primary);
        }

        .tooltip {
            position: absolute;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            color: var(--foreground);
            max-width: 250px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            pointer-events: none;
            line-height: 1.4;
        }

        .tooltip::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 12px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid var(--border);
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: -5px;
            left: 13px;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 5px solid var(--surface);
        }

        /* Advanced section enhancements for Wave 1 */
        .advanced-badge {
            font-size: 11px;
            color: var(--muted);
            font-style: italic;
            font-weight: 400;
            margin-left: 4px;
        }

        .advanced-settings summary {
            position: relative;
        }

        .advanced-settings summary::after {
            content: '‚ñº';
            position: absolute;
            right: 16px;
            transition: transform 0.2s;
            font-size: 10px;
        }

        .advanced-settings[open] summary::after {
            transform: rotate(180deg);
        }

        /* Light mode adjustments */
        body.light-mode .hero-box {
            background: linear-gradient(135deg, rgba(13, 148, 136, 0.08) 0%, transparent 100%);
        }

        body.light-mode .dropdown-options {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        body.light-mode .options-container {
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        }

        body.light-mode .options-nav {
            background: rgba(0, 0, 0, 0.02);
        }

        body.light-mode .setting-row {
            background: rgba(0, 0, 0, 0.02);
        }

        body.light-mode .guide-details,
        body.light-mode .advanced-settings {
            background: rgba(0, 0, 0, 0.02);
        }

        body.light-mode .card-content {
            background: rgba(0, 0, 0, 0.02);
        }

        body.light-mode .radio-card input:checked+.card-content {
            background: rgba(13, 148, 136, 0.1);
        }

        body.light-mode .nav-tab:hover {
            background: rgba(13, 148, 136, 0.05);
        }

        body.light-mode .nav-tab.active {
            background: rgba(13, 148, 136, 0.1);
        }

        body.light-mode .tab-panel h2 {
            color: var(--foreground);
        }

        /* Onboarding Checklist */
        .onboarding-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, transparent 100%);
            border: 2px solid var(--primary);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .onboarding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .onboarding-header h3 {
            margin: 0;
            font-size: 16px;
            color: var(--foreground);
        }

        .onboarding-dismiss {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--muted);
            cursor: pointer;
            padding: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .onboarding-dismiss:hover {
            background: rgba(0, 0, 0, 0.1);
            color: var(--foreground);
        }

        .onboarding-steps {
            list-style: none;
            padding: 0;
            margin: 0 0 16px 0;
        }

        .onboarding-steps li {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            font-size: 14px;
            color: var(--foreground);
        }

        .onboarding-steps .step-icon {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .onboarding-steps li.completed {
            color: var(--primary);
        }

        .onboarding-steps li.completed .step-icon {
            color: var(--primary);
        }

        .tab-description {
            font-size: 13px;
            color: var(--muted);
            margin: -16px 0 24px 0;
            line-height: 1.5;
        }

        body.light-mode .onboarding-card {
            background: linear-gradient(135deg, rgba(13, 148, 136, 0.08) 0%, transparent 100%);
        }

        body.light-mode .onboarding-dismiss:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        /* Responsive */
        @media (max-width: 700px) {
            .options-container {
                flex-direction: column;
            }

            .options-nav {
                width: 100%;
                min-width: auto;
                flex-direction: row;
                padding: 12px;
                overflow-x: auto;
                border-right: none;
                border-bottom: 1px solid var(--border);
            }

            .nav-header {
                display: none;
            }

            .nav-tab {
                padding: 10px 16px;
                border-left: none;
                border-bottom: 2px solid transparent;
                white-space: nowrap;
            }

            .nav-tab.active {
                border-left-color: transparent;
                border-bottom-color: var(--primary);
            }

            .nav-footer {
                display: none;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }

            .sensitivity-group {
                flex-direction: column;
            }
        }

        /* ================================
           Account / Auth Styles
           ================================ */
        .auth-section {
            animation: fadeSlideIn 0.25s ease forwards;
        }

        /* Loading State */
        .auth-loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            gap: 16px;
            color: var(--muted);
        }

        .auth-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Auth Hero (Logged Out) */
        .auth-hero {
            text-align: center;
            padding: 40px 24px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, transparent 100%);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-bottom: 20px;
        }

        .auth-hero-icon {
            margin-bottom: 20px;
            color: var(--primary);
        }

        .auth-hero-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--foreground);
            margin: 0 0 12px 0;
        }

        .auth-hero-desc {
            font-size: 14px;
            color: var(--muted);
            margin: 0 0 24px 0;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Google Sign-In Button */
        .btn-google-signin {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            background: #fff;
            border: 1px solid #dadce0;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #3c4043;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        .btn-google-signin:hover {
            background: #f8f9fa;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
        }

        .btn-google-signin:active {
            background: #f1f3f4;
        }

        .btn-google-signin:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Remember Me Checkbox */
        .auth-remember-me {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            font-size: 13px;
            color: var(--muted);
            cursor: pointer;
        }

        .auth-remember-me input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--primary);
        }

        /* Privacy Note */
        .auth-privacy-note {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 14px;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 12px;
            color: var(--muted);
        }

        .auth-privacy-note svg {
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* User Profile Card */
        .user-profile-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, transparent 100%);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .user-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--foreground);
        }

        .user-email {
            font-size: 13px;
            color: var(--muted);
        }

        .plan-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-top: 4px;
            width: fit-content;
        }

        .plan-badge.plan-free {
            background: var(--border);
            color: var(--muted);
        }

        .plan-badge.plan-pro {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            color: #fff;
        }

        /* Account Actions */
        .account-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .btn-action {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 14px 20px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--background);
            color: var(--foreground);
        }

        .btn-action:hover {
            border-color: var(--primary);
        }

        .btn-action.btn-upgrade {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(249, 115, 22, 0.1));
            border-color: #f59e0b;
            color: #f59e0b;
        }

        .btn-action.btn-upgrade:hover {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(249, 115, 22, 0.2));
        }

        .btn-action.btn-manage {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-action.btn-signout {
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.3);
        }

        .btn-action.btn-signout:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: #ef4444;
        }

        .btn-action.btn-retry {
            background: var(--primary);
            color: #fff;
            border: none;
        }

        .btn-action.btn-retry:hover {
            filter: brightness(1.1);
        }

        /* Sync Status Card */
        .sync-status-card {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 14px;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 13px;
            color: var(--muted);
        }

        .sync-status-card svg {
            flex-shrink: 0;
            color: var(--primary);
        }

        /* Auth Error State */
        .auth-error-card {
            text-align: center;
            padding: 40px 24px;
            background: rgba(239, 68, 68, 0.05);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 16px;
        }

        .auth-error-card svg {
            color: #ef4444;
            margin-bottom: 16px;
        }

        .auth-error-card h4 {
            font-size: 18px;
            color: var(--foreground);
            margin: 0 0 8px 0;
        }

        .auth-error-card .error-message {
            font-size: 14px;
            color: var(--muted);
            margin: 0 0 20px 0;
        }

        /* Light mode auth adjustments */
        body.light-mode .btn-google-signin {
            border-color: #dadce0;
        }

        body.light-mode .auth-hero {
            background: linear-gradient(135deg, rgba(13, 148, 136, 0.08) 0%, transparent 100%);
        }

        body.light-mode .user-profile-card {
            background: linear-gradient(135deg, rgba(13, 148, 136, 0.08) 0%, transparent 100%);
        }
    </style>
</head>

<body>
    <div class="options-container">
        <!-- Sidebar Navigation -->
        <nav class="options-nav">
            <div class="nav-header">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3" />
                        <path d="M12 1v6m0 6v10" />
                        <path d="m14.5 9.5 4.95-2.86M4.55 16.36l4.95-2.86" />
                        <path d="m9.5 9.5-4.95-2.86m14.9 9.72-4.95-2.86" />
                    </svg>
                    AmoNexus
                </h2>
            </div>

            <button class="nav-tab active" data-tab="general">
                <span class="nav-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </span>
                <span class="nav-label" data-i18n="opt_tab_general">Getting Started</span>
            </button>

            <button class="nav-tab" data-tab="ai">
                <span class="nav-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2v4" />
                        <path d="M12 18v4" />
                        <path d="M4.93 4.93l2.83 2.83" />
                        <path d="M16.24 16.24l2.83 2.83" />
                        <path d="M2 12h4" />
                        <path d="M18 12h4" />
                        <path d="M4.93 19.07l2.83-2.83" />
                        <path d="M16.24 7.76l2.83-2.83" />
                    </svg>
                </span>
                <span class="nav-label" data-i18n="opt_tab_ai">AI Features</span>
            </button>

            <button class="nav-tab" data-tab="connections">
                <span class="nav-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                    </svg>
                </span>
                <span class="nav-label" data-i18n="opt_tab_connections">Integrations</span>
            </button>

            <button class="nav-tab" data-tab="advanced">
                <span class="nav-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </span>
                <span class="nav-label" data-i18n="opt_tab_advanced">Developer Tools</span>
            </button>

            <button class="nav-tab" data-tab="account">
                <span class="nav-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                        <circle cx="12" cy="7" r="4" />
                    </svg>
                </span>
                <span class="nav-label" data-i18n="opt_tab_account">Account</span>
            </button>

            <div class="nav-footer">
                <button class="icon-btn" id="btn-theme-toggle" data-i18n-title="opt_theme_toggle_title"
                    title="Toggle Theme" style="width: 100%; justify-content: center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
                    </svg>
                </button>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="options-content">
            <!-- Tab 1: Chung (General) -->
            <div class="tab-panel active" id="panel-general">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                    <span data-i18n="opt_tab_general_title">Getting Started</span>
                </h2>
                <p class="tab-description" data-i18n="opt_tab_general_desc">
                    Set up your AI provider and basic preferences
                </p>

                <!-- Onboarding Checklist (shown on first visit) -->
                <div id="onboarding-checklist" class="onboarding-card" style="display: none;">
                    <div class="onboarding-header">
                        <h3 data-i18n="opt_onboarding_title">Quick Setup (4 steps)</h3>
                        <button class="onboarding-dismiss" aria-label="Dismiss">√ó</button>
                    </div>
                    <ul class="onboarding-steps">
                        <li id="onboarding-step-1" class="completed">
                            <span class="step-icon">‚òë</span>
                            <span data-i18n="opt_onboarding_step1">Choose your AI provider</span>
                        </li>
                        <li id="onboarding-step-2">
                            <span class="step-icon">‚òê</span>
                            <span data-i18n="opt_onboarding_step2">Get your free API key (click link below)</span>
                        </li>
                        <li id="onboarding-step-3">
                            <span class="step-icon">‚òê</span>
                            <span data-i18n="opt_onboarding_step3">Paste your key and click Save</span>
                        </li>
                        <li id="onboarding-step-4">
                            <span class="step-icon">‚òê</span>
                            <span data-i18n="opt_onboarding_step4">Start highlighting text on any webpage</span>
                        </li>
                    </ul>
                    <button id="btn-complete-setup" class="btn-action" style="width: 100%; margin-top: 12px;"
                        data-i18n="opt_onboarding_btn_complete">
                        Complete Setup
                    </button>
                </div>

                <!-- API Key Section with Provider Selector -->
                <div class="setting-section">
                    <!-- Provider Selector -->
                    <label data-i18n="opt_provider_label">AI Provider</label>
                    <div class="custom-dropdown" id="providerDropdown">
                        <div class="dropdown-selected" tabindex="0">
                            <span class="dropdown-text" data-i18n="opt_provider_google">Google Gemini</span>
                            <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="m6 9 6 6 6-6" />
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="google" data-i18n="opt_provider_google">
                                Google Gemini</div>
                            <div class="dropdown-option" data-value="openrouter" data-i18n="opt_provider_openrouter">
                                OpenRouter</div>
                        </div>
                    </div>
                    <input type="hidden" id="providerSelect" value="google">
                    <p class="hint-text" id="provider-hint" style="display: none;" data-i18n="opt_provider_hint">
                        OpenRouter: Access Llama 3, Mistral, DeepSeek (~50 free requests/day)</p>

                    <!-- Dual-Key Recommendation Card -->
                    <div class="dual-key-tip"
                        style="margin-top: 14px; padding: 14px 16px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.06) 0%, rgba(59, 130, 246, 0.04) 100%); border: 1px solid rgba(16, 185, 129, 0.15); border-radius: 12px; font-size: 13px; line-height: 1.6;">
                        <div style="display: flex; align-items: flex-start; gap: 10px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" style="flex-shrink: 0; margin-top: 2px; color: var(--primary);">
                                <path
                                    d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
                            </svg>
                            <div>
                                <strong style="color: var(--foreground);" data-i18n="opt_dual_key_title">üí° Khuy·∫øn ngh·ªã:
                                    Thi·∫øt l·∫≠p c·∫£ 2 key</strong>
                                <p style="margin: 6px 0 0; color: var(--muted);" data-i18n="opt_dual_key_desc">
                                    Amo s·ª≠ d·ª•ng AI ƒë·ªÉ ph√¢n t√≠ch v√† h·ªó tr·ª£ b·∫°n. M·ªói nh√† cung c·∫•p c√≥ gi·ªõi h·∫°n mi·ªÖn ph√≠
                                    ri√™ng. Khi thi·∫øt l·∫≠p c·∫£ <b>Gemini</b> (ph√¢n t√≠ch nhanh) l·∫´n <b>OpenRouter</b> (d·ª±
                                    ph√≤ng), Amo s·∫Ω t·ª± ƒë·ªông chuy·ªÉn ƒë·ªïi khi m·ªôt b√™n ƒë·∫°t gi·ªõi h·∫°n ‚Äî ƒë·∫£m b·∫£o tr·∫£i nghi·ªám ·ªïn
                                    ƒë·ªãnh kh√¥ng b·ªã gi√°n ƒëo·∫°n.
                                </p>
                                <ul style="margin: 8px 0 0; padding-left: 18px; color: var(--muted); font-size: 12px;">
                                    <li data-i18n="opt_dual_key_benefit1"><b>Gemini</b> ‚Äî mi·ªÖn ph√≠, nhanh, ch·∫•t l∆∞·ª£ng
                                        ph√¢n t√≠ch t·ªët nh·∫•t ‚Äî ƒë√¢y l√† l·ª±a ch·ªçn ch√≠nh c·ªßa Amo</li>
                                    <li data-i18n="opt_dual_key_benefit2"><b>OpenRouter</b> ‚Äî ~50 l∆∞·ª£t/ng√†y mi·ªÖn ph√≠, s·ª≠
                                        d·ª•ng c√°c model AI nh·ªè h∆°n n√™n tr·∫£i nghi·ªám s·∫Ω kh√¥ng b·∫±ng Gemini ‚Äî ƒë∆∞·ª£c xem l√†
                                        <b>ph∆∞∆°ng √°n d·ª± ph√≤ng</b> khi Gemini h·∫øt quota
                                    </li>
                                    <li data-i18n="opt_dual_key_benefit3">C·∫£ 2 key ƒë·ªÅu <b>mi·ªÖn ph√≠</b> v√† m·∫•t kho·∫£ng
                                        <b>30 gi√¢y</b> ƒë·ªÉ t·∫°o
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Google Gemini Key (Default) -->
                    <div id="google-key-section" style="margin-top: 16px;">
                        <div class="hero-box">
                            <a href="https://aistudio.google.com/app/apikey" target="_blank" class="btn-get-key"
                                data-i18n="opt_btn_get_key">
                                Google AI Studio
                            </a>
                        </div>

                        <label for="apiKeyInput">
                            <span data-i18n="opt_gemini_api_key">AI Access Key</span>
                            <span class="info-icon" data-tooltip-i18n="opt_gemini_api_key_tooltip"
                                aria-label="More information">‚ìò</span>
                        </label>
                        <input type="text" id="apiKeyInput" placeholder="AIzaSy..."
                            data-i18n-placeholder="opt_api_key_placeholder" autocomplete="off">

                        <details class="guide-details">
                            <summary data-i18n="opt_api_guide_toggle">Huong dan lay Key</summary>
                            <div class="guide-content">
                                <ol>
                                    <li data-i18n="opt_guide_1">Dang nhap Google AI Studio</li>
                                    <li data-i18n="opt_guide_2">Nhan "Get API Key"</li>
                                    <li data-i18n="opt_guide_3">Tao key trong project moi</li>
                                    <li data-i18n="opt_guide_4">Sao chep va dan vao tren</li>
                                </ol>
                            </div>
                        </details>
                    </div>

                    <!-- OpenRouter Key (Hidden by default) -->
                    <div id="openrouter-key-section" style="display: none; margin-top: 16px;">
                        <div class="hero-box">
                            <a href="https://openrouter.ai/keys" target="_blank" class="btn-get-key"
                                data-i18n="opt_btn_get_openrouter_key">
                                OpenRouter Keys
                            </a>
                        </div>

                        <label for="openrouterKeyInput" data-i18n="opt_openrouter_api_key">OpenRouter API Key</label>
                        <input type="text" id="openrouterKeyInput" placeholder="sk-or-v1-..."
                            data-i18n-placeholder="opt_openrouter_key_placeholder" autocomplete="off">

                        <label for="openrouterModelInput" style="margin-top: 12px;"
                            data-i18n="opt_openrouter_model">Model ID</label>
                        <input type="text" id="openrouterModelInput" placeholder="google/gemini-2.0-flash-exp:free"
                            data-i18n-placeholder="opt_openrouter_model_placeholder" autocomplete="off">
                        <p class="hint-text" data-i18n="opt_openrouter_model_hint">Free models:
                            google/gemini-2.0-flash-exp:free, meta-llama/llama-3.3-70b-instruct:free</p>

                        <details class="guide-details">
                            <summary data-i18n="opt_openrouter_guide_toggle">How to get OpenRouter Key</summary>
                            <div class="guide-content">
                                <ol>
                                    <li data-i18n="opt_openrouter_guide_1">Go to openrouter.ai/keys</li>
                                    <li data-i18n="opt_openrouter_guide_2">Sign in with Google/GitHub</li>
                                    <li data-i18n="opt_openrouter_guide_3">Create a new API key</li>
                                    <li data-i18n="opt_openrouter_guide_4">Copy and paste above</li>
                                </ol>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- Sensitivity Section -->
                <div class="setting-section">
                    <label data-i18n="opt_sens_label">Muc bao ve</label>
                    <div class="sensitivity-group">
                        <label class="radio-card">
                            <input type="radio" name="sensitivity" value="gentle">
                            <div class="card-content">
                                <span class="emoji">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path
                                            d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z" />
                                        <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12" />
                                    </svg>
                                </span>
                                <span class="title" data-i18n="opt_sens_gentle_title">Nhe nhang</span>
                                <span class="desc" data-i18n="opt_sens_gentle_desc">Nhac nho nhe</span>
                            </div>
                        </label>

                        <label class="radio-card">
                            <input type="radio" name="sensitivity" value="balanced" checked>
                            <div class="card-content">
                                <span class="emoji">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path
                                            d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
                                    </svg>
                                </span>
                                <span class="title" data-i18n="opt_sens_balanced_title">Can bang</span>
                                <span class="desc" data-i18n="opt_sens_balanced_desc">Tieu chuan</span>
                            </div>
                        </label>

                        <label class="radio-card">
                            <input type="radio" name="sensitivity" value="strict">
                            <div class="card-content">
                                <span class="emoji">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5" />
                                        <line x1="13" x2="19" y1="19" y2="13" />
                                        <line x1="16" x2="20" y1="16" y2="20" />
                                        <line x1="19" x2="21" y1="21" y2="19" />
                                        <polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5" />
                                        <line x1="5" x2="9" y1="14" y2="18" />
                                        <line x1="7" x2="4" y1="17" y2="20" />
                                        <line x1="3" x2="5" y1="19" y2="21" />
                                    </svg>
                                </span>
                                <span class="title" data-i18n="opt_sens_strict_title">Tap trung</span>
                                <span class="desc" data-i18n="opt_sens_strict_desc">Bao ve cao</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- User Persona Section (Advanced) -->
                <details class="advanced-settings" style="margin-top: 16px;">
                    <summary>
                        <span data-i18n="opt_advanced_settings_title">Advanced Settings</span>
                        <span class="advanced-badge" data-i18n="opt_advanced_badge">(For advanced users)</span>
                    </summary>
                    <div class="advanced-content">
                        <div class="setting-section">
                            <label for="userPersona" data-i18n="opt_user_persona_title">User Role</label>
                            <input type="text" id="userPersona" placeholder="e.g. Doctor, Student, Engineer..."
                                data-i18n-placeholder="opt_user_persona_placeholder">
                            <p class="hint-text" data-i18n="opt_user_persona_desc">AI will adjust explanations to match
                                your expertise.</p>
                        </div>
                    </div>
                </details>

                <!-- Language Section -->
                <div class="setting-section">
                    <label data-i18n="opt_lang_title">Ngon ngu</label>
                    <div class="custom-dropdown" id="languageDropdown">
                        <div class="dropdown-selected" tabindex="0">
                            <span class="dropdown-text" data-i18n="opt_lang_auto">Tu dong (Chrome UI)</span>
                            <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="m6 9 6 6 6-6" />
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="auto" data-i18n="opt_lang_auto">Tu dong
                                (Chrome UI)</div>
                            <div class="dropdown-option" data-value="vi" data-i18n="opt_lang_vi">Tieng Viet</div>
                            <div class="dropdown-option" data-value="en" data-i18n="opt_lang_en">English</div>
                        </div>
                    </div>
                    <input type="hidden" id="languageSelect" value="auto">
                </div>
            </div>

            <!-- Tab 2: AI Pilot -->
            <div class="tab-panel" id="panel-ai">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2v4" />
                        <path d="M12 18v4" />
                        <path d="M4.93 4.93l2.83 2.83" />
                        <path d="M16.24 16.24l2.83 2.83" />
                        <path d="M2 12h4" />
                        <path d="M18 12h4" />
                        <path d="M4.93 19.07l2.83-2.83" />
                        <path d="M16.24 7.76l2.83-2.83" />
                    </svg>
                    <span data-i18n="opt_tab_ai_title">AI Features</span>
                </h2>
                <p class="tab-description" data-i18n="opt_tab_ai_desc">
                    Enable AI-powered reading assistance
                </p>

                <!-- AI Pilot Enable Toggle -->
                <div class="setting-section">
                    <div class="setting-row">
                        <div class="setting-row-info">
                            <div class="title" data-i18n="opt_ai_pilot_enable_title">Bat AI Pilot</div>
                            <div class="desc" data-i18n="opt_ai_pilot_enable_desc">Phan tich hanh vi tu dong</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="aiPilotEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- AI & Semantic Features -->
                <div class="setting-section">
                    <label data-i18n="opt_semantic_section_title">AI &amp; Semantic Features</label>
                    <p class="hint-text" data-i18n="opt_semantic_section_desc">Find related highlights by meaning, not
                        just
                        recency.</p>
                    <p class="hint-text warning" data-i18n="opt_semantic_cost_warning">Warning: May increase Gemini API
                        usage
                        and latency.</p>
                    <p class="hint-text" id="semantic-key-required" data-i18n="opt_semantic_key_required">Add your API
                        key to
                        enable these toggles.</p>
                    <div class="setting-row">
                        <div class="setting-row-info">
                            <div class="title">
                                <span data-i18n="opt_semantic_embeddings_title">Meaning Analysis</span>
                                <span class="info-icon" data-tooltip-i18n="opt_semantic_embeddings_tooltip"
                                    aria-label="More information">‚ìò</span>
                            </div>
                            <div class="desc" data-i18n="opt_semantic_embeddings_desc">Creates a semantic fingerprint
                                for each
                                highlight.</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="semanticEmbeddingsEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-row" style="margin-top: 12px;">
                        <div class="setting-row-info">
                            <div class="title">
                                <span data-i18n="opt_semantic_search_title">Find by Meaning</span>
                                <span class="info-icon" data-tooltip-i18n="opt_semantic_search_tooltip"
                                    aria-label="More information">‚ìò</span>
                            </div>
                            <div class="desc" data-i18n="opt_semantic_search_desc">Uses embeddings to pick top related
                                highlights in the same domain.</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="semanticSearchEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- AI Mode -->
                <div class="setting-section">
                    <label for="aiPilotMode">
                        <span data-i18n="opt_ai_pilot_mode">Che do hoat dong</span>
                        <span class="info-icon" data-tooltip-i18n="opt_ai_pilot_mode_tooltip"
                            aria-label="More information">‚ìò</span>
                    </label>
                    <div class="custom-dropdown" id="aiPilotModeDropdown">
                        <div class="dropdown-selected" tabindex="0">
                            <span class="dropdown-text" data-i18n="opt_ai_pilot_mode_shadow">Che do Bong</span>
                            <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="m6 9 6 6 6-6" />
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="shadow"
                                data-i18n="opt_ai_pilot_mode_shadow">Che
                                do Bong</div>
                            <div class="dropdown-option" data-value="assist" data-i18n="opt_ai_pilot_mode_assist">Tro ly
                            </div>
                            <div class="dropdown-option" data-value="primary" data-i18n="opt_ai_pilot_mode_primary">Chu
                                dong</div>
                        </div>
                    </div>
                    <input type="hidden" id="aiPilotMode" value="shadow">
                    <p class="hint-text" data-i18n="opt_ai_pilot_mode_hint">Bong: chi quan sat. Tro ly: goi y. Chu dong:
                        tu hanh dong.</p>
                </div>

                <!-- Accuracy Level -->
                <div class="setting-section">
                    <label for="aiAccuracyLevel">
                        <span data-i18n="opt_ai_pilot_accuracy_level">Do chinh xac</span>
                        <span class="info-icon" data-tooltip-i18n="opt_ai_pilot_accuracy_tooltip"
                            aria-label="More information">‚ìò</span>
                    </label>
                    <div class="custom-dropdown" id="aiAccuracyLevelDropdown">
                        <div class="dropdown-selected" tabindex="0">
                            <span class="dropdown-text" data-i18n="opt_ai_pilot_accuracy_balanced">Can bang</span>
                            <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="m6 9 6 6 6-6" />
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="balanced"
                                data-i18n="opt_ai_pilot_accuracy_balanced">Can bang</div>
                            <div class="dropdown-option" data-value="high" data-i18n="opt_ai_pilot_accuracy_high">Cao
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="aiAccuracyLevel" value="balanced">
                    <p class="hint-text" data-i18n="opt_ai_pilot_accuracy_hint">C√¢n b·∫±ng: nhanh h∆°n. Cao: ch√≠nh x√°c h∆°n
                        nh∆∞ng ch·∫≠m h∆°n v√† t·ªën th√™m chi ph√≠.</p>
                </div>

                <!-- Advanced AI Settings -->
                <details class="advanced-settings">
                    <summary>
                        <span data-i18n="opt_advanced_settings_title">Advanced Settings</span>
                        <span class="advanced-badge" data-i18n="opt_advanced_badge">(For advanced users)</span>
                    </summary>
                    <div class="advanced-content">
                        <div class="settings-grid">
                            <div>
                                <label for="aiMinConfidence" data-i18n="opt_ai_pilot_min_confidence">Minimum confidence
                                    level</label>
                                <input type="text" id="aiMinConfidence" placeholder="0.65">
                            </div>
                            <div>
                                <label for="aiTimeoutMs">
                                    <span data-i18n="opt_ai_pilot_timeout_ms">Time limit</span>
                                    <span class="info-icon" data-tooltip-i18n="opt_ai_pilot_timeout_tooltip"
                                        aria-label="More information">‚ìò</span>
                                </label>
                                <input type="text" id="aiTimeoutMs" placeholder="800">
                                <small class="hint" data-i18n="opt_ai_pilot_timeout_hint">Maximum wait time for AI
                                    response (in milliseconds)</small>
                            </div>
                        </div>

                        <div class="settings-grid" style="margin-top: 12px;">
                            <div>
                                <label for="aiBudgetPerDay">
                                    <span data-i18n="opt_ai_pilot_budget_per_day">Daily quota</span>
                                    <span class="info-icon" data-tooltip-i18n="opt_ai_pilot_budget_tooltip"
                                        aria-label="More information">‚ìò</span>
                                </label>
                                <input type="text" id="aiBudgetPerDay" placeholder="30">
                                <small class="hint" data-i18n="opt_ai_pilot_budget_hint">Number of AI calls allowed per
                                    day</small>
                            </div>
                            <div>
                                <label for="aiCacheTtlMs" data-i18n="opt_ai_pilot_cache_ttl_ms">Temporary storage
                                    time</label>
                                <input type="text" id="aiCacheTtlMs" placeholder="900000">
                                <small class="hint" data-i18n="opt_ai_pilot_cache_ttl_hint">How long to remember recent
                                    results (in milliseconds)</small>
                            </div>
                        </div>

                        <!-- Hidden: managed automatically by hybrid rule-first system -->
                        <div style="display: none;">
                            <div class="settings-grid" style="margin-top: 12px;">
                                <div>
                                    <label for="aiMaxViewportChars" data-i18n="opt_ai_pilot_max_viewport_chars">Viewport
                                        chars</label>
                                    <input type="text" id="aiMaxViewportChars" placeholder="1200">
                                </div>
                                <div>
                                    <label for="aiMaxSelectedChars" data-i18n="opt_ai_pilot_max_selected_chars">Selected
                                        chars</label>
                                    <input type="text" id="aiMaxSelectedChars" placeholder="400">
                                </div>
                            </div>

                            <div style="margin-top: 12px;">
                                <label for="aiProvider" data-i18n="opt_ai_pilot_provider">Nha cung cap</label>
                                <div class="custom-dropdown" id="aiProviderDropdown">
                                    <div class="dropdown-selected" tabindex="0">
                                        <span class="dropdown-text"
                                            data-i18n="opt_ai_pilot_provider_gemini">Gemini</span>
                                        <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16"
                                            height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="m6 9 6 6 6-6" />
                                        </svg>
                                    </div>
                                    <div class="dropdown-options">
                                        <div class="dropdown-option selected" data-value="gemini"
                                            data-i18n="opt_ai_pilot_provider_gemini">Gemini</div>
                                        <div class="dropdown-option" data-value="proxy"
                                            data-i18n="opt_ai_pilot_provider_proxy">
                                            Proxy</div>
                                    </div>
                                </div>
                                <input type="hidden" id="aiProvider" value="gemini">
                            </div>

                            <div style="margin-top: 12px;">
                                <label for="aiProxyUrl" data-i18n="opt_ai_pilot_proxy_url">Proxy URL</label>
                                <input type="text" id="aiProxyUrl" placeholder="https://your-proxy/decide">
                            </div>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Tab 3: Connections -->
            <div class="tab-panel" id="panel-connections">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                    </svg>
                    <span data-i18n="opt_tab_connections_title">Integrations</span>
                </h2>
                <p class="tab-description" data-i18n="opt_tab_connections_desc">
                    Connect with NotebookLM and other tools
                </p>

                <!-- NotebookLM Toggle -->
                <div class="setting-section">
                    <div class="setting-row">
                        <div class="setting-row-info">
                            <div class="title" data-i18n="opt_nlm_enable_title">NotebookLM Bridge</div>
                            <div class="desc" data-i18n="opt_nlm_enable_desc">Luu ghi chu vao NotebookLM</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="nlmEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Default Notebook -->
                <div class="setting-section">
                    <label for="nlmDefaultNotebook" data-i18n="opt_nlm_default_notebook">So tay mac dinh</label>
                    <input type="text" id="nlmDefaultNotebook" placeholder="Inbox">
                </div>

                <!-- Bridge Mode -->
                <div class="setting-section">
                    <label for="nlmMode" data-i18n="opt_nlm_mode">Che do ket noi</label>
                    <select id="nlmMode">
                        <option value="ui_assisted" data-i18n="opt_nlm_mode_ui_assisted">UI-Assisted (Khuyen dung)
                        </option>
                        <option value="enterprise_api" disabled data-i18n="opt_nlm_mode_enterprise">Enterprise API (Sap
                            co)</option>
                    </select>
                    <p class="hint-text" data-i18n="opt_nlm_mode_hint">Sao chep vao clipboard + mo NotebookLM de dan thu
                        cong</p>
                </div>

                <!-- PII Warning Toggle -->
                <div class="setting-section">
                    <div class="setting-row">
                        <div class="setting-row-info">
                            <div class="title" data-i18n="opt_nlm_pii_warning">Canh bao du lieu nhay cam</div>
                            <div class="desc" data-i18n="opt_nlm_pii_warning_desc">Hien canh bao khi export du lieu ca
                                nhan</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="nlmPiiWarning" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Allow Cloud Export Toggle -->
                <div class="setting-section">
                    <div class="setting-row">
                        <div class="setting-row-info">
                            <div class="title" data-i18n="opt_nlm_allow_cloud">Cho phep export cloud</div>
                            <div class="desc" data-i18n="opt_nlm_allow_cloud_desc">Cho phep gui "ATOM Clip" len
                                NotebookLM</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="nlmAllowCloud">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Advanced NLM Settings -->
                <details class="advanced-settings">
                    <summary>
                        <span data-i18n="opt_advanced_settings_title">Advanced Settings</span>
                        <span class="advanced-badge" data-i18n="opt_advanced_badge">(For advanced users)</span>
                    </summary>
                    <div class="advanced-content">
                        <div class="settings-grid">
                            <div>
                                <label for="nlmBaseUrl" data-i18n="opt_nlm_base_url">NotebookLM URL</label>
                                <input type="text" id="nlmBaseUrl" placeholder="https://notebooklm.google.com">
                            </div>
                            <div>
                                <label for="nlmExportMaxChars" data-i18n="opt_nlm_export_max_chars">Ky tu toi da</label>
                                <input type="number" id="nlmExportMaxChars" placeholder="5000" min="0" max="50000"
                                    step="500">
                                <p class="hint-text">0 = khong gioi han</p>
                            </div>
                        </div>

                        <div style="margin-top: 12px;">
                            <label for="nlmSensitiveDomains" data-i18n="opt_nlm_sensitive_domains">Domain nhay cam (moi
                                dong 1)</label>
                            <textarea id="nlmSensitiveDomains" rows="3" placeholder="*.his.*&#10;*.emr.*"></textarea>
                        </div>

                        <div style="margin-top: 12px;">
                            <label for="nlmRulesJson" data-i18n="opt_nlm_rules">Quy tac mapping (JSON)</label>
                            <textarea id="nlmRulesJson" rows="4"
                                placeholder='{"byTag":[{"tag":"research","notebookRef":"Research"}]}'></textarea>
                        </div>
                    </div>
                </details>

                <div class="setting-section" style="margin-top: 16px;">
                    <label for="srq-density-mode" data-i18n="opt_srq_density_label">Smart Research Queue density</label>
                    <select id="srq-density-mode">
                        <option value="comfortable" data-i18n="opt_srq_density_comfortable">Comfortable (default)
                        </option>
                        <option value="compact" data-i18n="opt_srq_density_compact">Compact (more items per screen)
                        </option>
                    </select>
                    <p class="hint-text" data-i18n="opt_srq_density_hint">Comfortable mode is easier to read. Compact
                        mode shows more highlights.</p>
                </div>
            </div>

            <!-- Tab 4: Advanced -->
            <div class="tab-panel" id="panel-advanced">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                    <span data-i18n="opt_tab_advanced_title">Developer Tools</span>
                </h2>
                <p class="tab-description" data-i18n="opt_tab_advanced_desc">
                    Debugging and diagnostic tools
                </p>

                <!-- Debug Mode Section -->
                <div id="debug-section">
                    <div class="subsection-header">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m8 2 1.88 1.88" />
                            <path d="M14.12 3.88 16 2" />
                            <path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1" />
                            <path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6" />
                            <path d="M12 20v-9" />
                            <path d="M6.53 9C4.6 8.8 3 7.1 3 5" />
                            <path d="M6 13H2" />
                            <path d="M3 21c0-2.1 1.7-3.9 3.8-4" />
                            <path d="M20.97 5c0 2.1-1.6 3.8-3.5 4" />
                            <path d="M22 13h-4" />
                            <path d="M17.2 17c2.1.1 3.8 1.9 3.8 4" />
                        </svg>
                        <span data-i18n="opt_debug_title">Go loi</span>
                    </div>

                    <div class="setting-section">
                        <div class="setting-row">
                            <div class="setting-row-info">
                                <div class="title" data-i18n="opt_debug_enable_title">Bat che do Go loi</div>
                                <div class="desc" data-i18n="opt_debug_enable_desc">Hien log chi tiet trong console
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="debugModeToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="setting-section">
                        <button id="btn-export-debug" class="btn-action" style="width: 100%;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                <polyline points="7 10 12 15 17 10" />
                                <line x1="12" x2="12" y1="15" y2="3" />
                            </svg>
                            <span data-i18n="opt_debug_export">Xuat Debug Log</span>
                        </button>
                    </div>
                </div>

                <!-- Notifications Section -->
                <div class="subsection-header">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" />
                        <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" />
                    </svg>
                    <span data-i18n="opt_notif_title">Thong bao</span>
                </div>

                <div class="setting-section">
                    <p class="hint-text" style="margin-bottom: 12px;" data-i18n="opt_notif_desc">
                        Kiem tra va cau hinh thong bao he thong cho che do Tap trung.
                    </p>

                    <div class="settings-grid">
                        <button id="btn-test-notif" class="btn-action">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" />
                                <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" />
                            </svg>
                            <span data-i18n="opt_notif_test">Thu thong bao</span>
                        </button>
                        <button id="btn-open-chrome-notif" class="btn-action">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                            <span data-i18n="opt_notif_chrome">Chrome Settings</span>
                        </button>
                    </div>

                    <div id="notif-status"
                        style="text-align: center; font-size: 13px; min-height: 20px; margin-top: 12px;">
                    </div>
                </div>

                <details class="guide-details">
                    <summary data-i18n="opt_notif_guide_title">Huong dan xu ly su co</summary>
                    <div class="guide-content">
                        <p style="margin: 0 0 8px 0; color: var(--muted);" data-i18n="opt_notif_guide_intro">Neu thong
                            bao khong hien:</p>
                        <ol>
                            <li data-i18n="opt_notif_guide_1"><b>Windows:</b> Settings > System > Notifications > Chrome
                                > ON</li>
                            <li data-i18n="opt_notif_guide_2"><b>Focus Assist:</b> Tat hoac dat Priority only</li>
                            <li data-i18n="opt_notif_guide_3"><b>Chrome:</b> Nhan "Chrome Settings" > Cho phep thong bao
                            </li>
                            <li data-i18n="opt_notif_guide_4"><b>Khoi dong lai:</b> Dong va mo lai Chrome</li>
                        </ol>
                    </div>
                </details>
            </div>

            <!-- Tab: Account -->
            <div class="tab-panel" id="panel-account">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                        <circle cx="12" cy="7" r="4" />
                    </svg>
                    <span data-i18n="opt_account_title">Account</span>
                </h2>

                <!-- Loading State -->
                <div id="auth-loading" class="auth-section">
                    <div class="auth-loading-container">
                        <div class="auth-spinner"></div>
                        <span data-i18n="opt_account_loading">Loading...</span>
                    </div>
                </div>

                <!-- Logged Out State -->
                <div id="auth-logged-out" class="auth-section" style="display: none;">
                    <div class="auth-hero">
                        <div class="auth-hero-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                            </svg>
                        </div>
                        <h3 class="auth-hero-title" data-i18n="opt_account_signin_title">Sign in to AmoNexus</h3>
                        <p class="auth-hero-desc" data-i18n="opt_account_signin_desc">
                            Sign in to sync your data across devices and unlock Pro features.
                        </p>

                        <!-- Google Sign In Button -->
                        <button id="btn-google-signin" class="btn-google-signin">
                            <svg class="google-icon" width="20" height="20" viewBox="0 0 24 24">
                                <path fill="#4285F4"
                                    d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                                <path fill="#34A853"
                                    d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                <path fill="#FBBC05"
                                    d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                <path fill="#EA4335"
                                    d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                            </svg>
                            <span data-i18n="opt_account_signin_google">Sign in with Google</span>
                        </button>

                        <!-- Remember Me -->
                        <label class="auth-remember-me">
                            <input type="checkbox" id="auth-remember-me" checked>
                            <span data-i18n="opt_account_remember_me">Remember me for 7 days</span>
                        </label>
                    </div>

                    <div class="auth-privacy-note">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10" />
                            <path d="M12 16v-4" />
                            <path d="M12 8h.01" />
                        </svg>
                        <span data-i18n="opt_account_privacy_note">
                            We only use your email for account management. Your data stays on your device.
                        </span>
                    </div>
                </div>

                <!-- Logged In State -->
                <div id="auth-logged-in" class="auth-section" style="display: none;">
                    <!-- User Profile Card -->
                    <div class="user-profile-card">
                        <img id="user-avatar" src="icons/icon128.png" alt="Avatar" class="user-avatar"
                            onerror="this.src='icons/icon128.png'">
                        <div class="user-info">
                            <span id="user-name" class="user-name">User Name</span>
                            <span id="user-email" class="user-email">email@example.com</span>
                            <span id="user-plan-badge" class="plan-badge plan-free">Free</span>
                        </div>
                    </div>

                    <!-- Account Actions -->
                    <div class="account-actions">
                        <!-- Free Tier Note (replaces Upgrade button for now) -->
                        <div
                            style="padding: 18px 20px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.06) 0%, rgba(59, 130, 246, 0.04) 100%); border: 1px solid rgba(16, 185, 129, 0.15); border-radius: 14px; line-height: 1.7;">
                            <div style="display: flex; align-items: flex-start; gap: 12px;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round"
                                    style="flex-shrink: 0; margin-top: 2px; color: var(--primary);">
                                    <path
                                        d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
                                </svg>
                                <div>
                                    <strong style="font-size: 14px; color: var(--foreground);"
                                        data-i18n="opt_free_tier_title">üéÅ T·∫•t c·∫£ t√≠nh nƒÉng ƒë·ªÅu mi·ªÖn ph√≠</strong>
                                    <p style="margin: 8px 0 0; font-size: 13px; color: var(--muted);"
                                        data-i18n="opt_free_tier_desc">
                                        Hi·ªán t·∫°i, b·∫°n ƒëang ƒë∆∞·ª£c tr·∫£i nghi·ªám to√†n b·ªô t√≠nh nƒÉng c·ªßa Amo ho√†n to√†n mi·ªÖn
                                        ph√≠. Ch√∫ng t√¥i mu·ªën b·∫°n c√≥ ƒë·ªß th·ªùi gian kh√°m ph√° v√† c·∫£m nh·∫≠n gi√° tr·ªã th·ª±c s·ª± m√†
                                        Amo mang l·∫°i.
                                    </p>
                                    <p style="margin: 8px 0 0; font-size: 13px; color: var(--muted);"
                                        data-i18n="opt_free_tier_future">
                                        Trong c√°c phi√™n b·∫£n ti·∫øp theo, Amo s·∫Ω ti·∫øp t·ª•c ph√°t tri·ªÉn th√™m nhi·ªÅu t√≠nh nƒÉng
                                        h·ªØu √≠ch h∆°n n·ªØa. ƒê·ªÉ duy tr√¨ v√† n√¢ng cao ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m, ch√∫ng t√¥i s·∫Ω gi·ªõi
                                        thi·ªáu g√≥i Pro ‚Äî nh·∫±m t·∫°o ngu·ªìn l·ª±c ph√°t tri·ªÉn b·ªÅn v·ªØng, mang ƒë·∫øn gi√° tr·ªã l·ªõn h∆°n
                                        cho ng∆∞·ªùi d√πng.
                                    </p>
                                    <p style="margin: 10px 0 0; font-size: 12px; color: var(--primary); font-style: italic;"
                                        data-i18n="opt_free_tier_thanks">
                                        C·∫£m ∆°n b·∫°n ƒë√£ ƒë·ªìng h√†nh c√πng Amo. S·ª± ·ªßng h·ªô c·ªßa b·∫°n l√† ƒë·ªông l·ª±c l·ªõn nh·∫•t ƒë·ªÉ
                                        ch√∫ng t√¥i ti·∫øp t·ª•c. üíö
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Manage Subscription (Pro users - hidden for now) -->
                        <button id="btn-upgrade-pro" class="btn-action btn-upgrade" style="display: none;">
                            <span data-i18n="opt_account_upgrade">Upgrade to Pro</span>
                        </button>
                        <button id="btn-manage-subscription" class="btn-action btn-manage" style="display: none;">
                            <span data-i18n="opt_account_manage">Manage Subscription</span>
                        </button>

                        <!-- Sign Out -->
                        <button id="btn-signout" class="btn-action btn-signout">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                                <polyline points="16 17 21 12 16 7" />
                                <line x1="21" y1="12" x2="9" y2="12" />
                            </svg>
                            <span data-i18n="opt_account_signout">Sign Out</span>
                        </button>
                    </div>

                    <!-- Sync Info -->
                    <div class="sync-status-card">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10" />
                            <line x1="12" y1="8" x2="12" y2="12" />
                            <line x1="12" y1="16" x2="12.01" y2="16" />
                        </svg>
                        <span data-i18n="opt_account_sync_info">
                            Your settings are stored locally. Cloud sync coming soon!
                        </span>
                    </div>
                </div>

                <!-- Error State -->
                <div id="auth-error" class="auth-section" style="display: none;">
                    <div class="auth-error-card">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10" />
                            <line x1="15" y1="9" x2="9" y2="15" />
                            <line x1="9" y1="9" x2="15" y2="15" />
                        </svg>
                        <h4 data-i18n="opt_account_error_title">Something went wrong</h4>
                        <p id="auth-error-message" class="error-message"></p>
                        <button id="btn-retry-signin" class="btn-action btn-retry">
                            <span data-i18n="opt_account_retry">Try Again</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Save Bar -->
            <div class="save-bar">
                <button id="btn-save">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                        <polyline points="17 21 17 13 7 13 7 21" />
                        <polyline points="7 3 7 8 15 8" />
                    </svg>
                    <span data-i18n="opt_btn_save">Luu thay doi</span>
                </button>
                <div id="status"></div>
            </div>
        </main>
    </div>

    <script src="lib/supabase.min.js"></script>
    <script src="config/build_flags.js"></script>
    <script src="utils/console_guard.js"></script>
    <script src="utils_ui.js"></script>
    <script src="options.js"></script>
</body>

</html>